
# 摘要

本研究针对江苏省13个地级市2018年7月至2023年12月的空气质量综合指数进行了系统分析与建模。研究首先对原始数据进行清洗与插值处理，采用基于四分位距的异常值检测方法和三次样条插值、ARIMA预测插值、逆距离加权（IDW）插值、克里金（Kriging）插值的插值方法处理缺失数据。在此基础上，构建了考虑污染源排放、气象因素和环境承载力的空气质量微分方程模型，通过最小二乘法估计模型参数并进行稳定性分析。同时，采用SARIMA和Prophet两种时间序列预测模型对各市空气质量进行预测，通过MSE评估模型性能并选择最优模型用于2024年预测。研究发现，沿海城市（盐城、南通、苏州、连云港）空气质量普遍优于内陆城市，徐州和宿迁的空气质量最差且预测难度最大。基于模型分析结果，提出了分区精准管控、动态模型优化和差异化生态补偿等区域协同治理策略。研究成果为江苏省空气质量管理和污染防治提供了科学依据和决策支持。

关键词 ：空气质量综合指数；微分方程模型；时间序列预测；SARIMA模型；Prophet模型；区域协同治理




# 一、问题重述

江苏省共有13个地级市，自2018年7月至2023年12月，各市记录了月度空气质量综合指数（常以AQI表示）的变化情况。研究的主要任务包括：

对原始数据进行清洗和插值，考虑气象、经济、地理因素，建立空气质量综合指数的微分方程模型，并进行未来预测和区域协同治理分析，以期揭示影响空气质量的主要因素，预测未来空气质量，提出有效的污染控制策略。

研究意义：空气质量直接关系公众健康和生态环境。江苏省工业发达、人口密集，PM2.5、VOCs等污染物对区域大气质量影响显著。有效的数据处理和精确的预测模型可为政府决策和协同治理提供科学依据。本研究以数学建模常见框架展开，对数据和模型进行详细分析，以期得到完整的建模报告。

# 二、符号说明

* $A_i(t)$：第$i$市在时间$t$的空气质量综合指数。
* $t$：时间（以月为单位，从2018年7月算起）。
* $E_i(t)$：第$i$市在时间$t$的污染源排放强度指标（可通过工业能耗、机动车保有量等代理）。
* $M_i(t)$：第$i$市在时间$t$的气象因素向量（包括温度、湿度、风速、降水量等）。
* $G_i$：第$i$市的地理特征（包括海拔、地形类型等）。
* $C_i$：第$i$市的社会经济指标（人均GDP、人口密度、能源消费等）。
* $Q_1, Q_3$：数据的上下四分位数
* $IQR$：四分位距，$IQR = Q_3 - Q_1$
* $k$：异常值判定的阈值系数（本研究中取1.5）
* $\hat{y}(t)$：时间$t$处的插值估计值
* $y_i$：已知数据点的值
* $t_i$：已知数据点的时间
* $w_i$：插值权重
* $h$：带宽参数
* $\gamma(h)$：半变异函数
* $d_{ij}$：城市$i$和$j$之间的距离
* $s_i$：第$i$个采样点的空间位置
* 其它常用符号：$\alpha$, $\beta$, $\gamma$, $\lambda$表示模型参数，$rho_{ij}$表示城市$i,j$之间的空间关联权重等。

# 三、模型假设

为构建合理模型并简化计算，提出以下假设：

* **主要影响因素：** 空气质量主要受工业排放、交通排放、季节性气象条件等综合影响，忽略极端事件（如工厂爆炸、森林火灾等偶发因素）对分析结果的短期干扰。各市的污染源排放可通过相应的经济社会指标近似反映。

* **空间扩散：** 污染物在相邻城市间通过气流扩散并产生影响，假设这种扩散可通过固定的空间关联参数$rho_{ij}$来表示，各城市间互影响具有空间连续性。

* **指数连续性：** 空气质量综合指数随时间变化平滑，数据中可能存在测量误差或缺失，需要通过插值方法进行修正和补全；忽略人为监测系统的大规模系统性误差。

* **经济社会稳定：** 短期内（年内）社会经济指标相对稳定，可视为模型中常数；长期建模时可按年变化更新。人口、工业结构等对污染的影响通过线性或弱非线性关系体现。

* **模型形式：** 空气质量变化可用常微分方程描述（可视作“污染累积-扩散-沉降”的一阶动力学过程），假设其解决方案不存在奇异爆发，在参数符合实际范围时系统稳定。


# 四、数据清洗与插值

## 4.1. 数据清洗

### 4.1.1 缺失值识别
原始数据中的缺失值以反斜杠（\）标记。我们首先对数据进行扫描，识别出所有缺失位置，建立缺失值索引矩阵$M_{ij}$，其中$i$表示城市，$j$表示时间点：

$$
M_{ij} = \begin{cases}
1, & \text{如果}(i,j)\text{位置数据缺失} \\
0, & \text{其他情况}
\end{cases}
$$

### 4.1.2 异常值检测
采用基于四分位距（IQR）的方法检测异常值。对每个城市的时间序列数据：

1. 计算上下四分位数$Q_1$和$Q_3$
2. 计算四分位距：$IQR = Q_3 - Q_1$
3. 定义异常值判定区间：
   $$[Q_1 - k\cdot IQR, Q_3 + k\cdot IQR]$$
   其中$k=1.5$
4. 超出此区间的数据点标记为异常值

## 4.2. 数据插值

### 4.2.1 时间序列插值方法

#### 三次样条插值
对单个城市的时间序列进行插值，保持数据的光滑性。三次样条函数在每个区间$[t_i,t_{i+1}]$上的形式为：

$$S_i(t) = a_i(t-t_i)^3 + b_i(t-t_i)^2 + c_i(t-t_i) + d_i$$

满足：
- 函数值连续性：$S_i(t_{i+1}) = S_{i+1}(t_{i+1})$
- 一阶导数连续性：$S_i'(t_{i+1}) = S_{i+1}'(t_{i+1})$
- 二阶导数连续性：$S_i''(t_{i+1}) = S_{i+1}''(t_{i+1})$

#### ARIMA预测插值
对时间序列建立ARIMA(p,d,q)模型：

$$\phi(B)(1-B)^d X_t = \theta(B)\varepsilon_t$$

其中：
- $B$为滞后算子
- $\phi(B)$为自回归多项式
- $\theta(B)$为移动平均多项式
- $d$为差分阶数

### 4.2.2 空间插值方法

#### 逆距离加权（IDW）插值
基于距离的空间插值方法，估计值计算公式：

$$\hat{y}(s_0) = \frac{\sum_{i=1}^n w_i y_i}{\sum_{i=1}^n w_i}, \quad w_i = \frac{1}{d_{i0}^p}$$

其中：
- $d_{i0}$为待估计点与已知点间的距离
- $p$为距离幂次（通常取2）

#### 克里金（Kriging）插值
考虑空间相关性的最优线性无偏估计：

$$\hat{y}(s_0) = \sum_{i=1}^n \lambda_i y(s_i)$$

其中权重$\lambda_i$通过求解克里金方程组获得：

$$\begin{cases}
\sum_{j=1}^n \lambda_j \gamma(h_{ij}) + \mu = \gamma(h_{i0}), & i=1,\ldots,n \\
\sum_{j=1}^n \lambda_j = 1
\end{cases}$$

$\gamma(h)$为半变异函数，描述空间相关性。


## 4.3. 插值方法比较

### 4.3.1 时间序列插值特点
- 三次样条插值：适用于数据变化平滑、缺失点较少的情况，能保持曲线的光滑性
- ARIMA预测插值：适合具有明显时间依赖性和季节性的数据，可捕捉数据的动态特征

### 4.3.2 空间插值特点
- IDW插值：计算简单，适用于采样点分布均匀、地理变化较小的区域
- 克里金插值：考虑空间相关性，适用于具有空间结构特征的数据，可提供估计误差

### 4.3.3 方法选择
- 对于时间连续性强的缺失：优先使用时间序列插值
- 对于空间相关性强的缺失：优先使用空间插值

由于空气质量综合指数数据具有明显的时间依赖性和季节性，且存在空间结构特征，因此优先选择ARIMA预测插值的结果在后续建模中使用。
具体插值方法的敏感度分析将在模型检验与评价之后详细讨论



# 五、空气质量微分方程模型分析

## 5.1.模型构建

根据提供的数据和微分方程框架，我们建立了江苏省各市空气质量综合指数的动态模型。模型的输入变量包括以下关键因素：

### 污染源排放指标 $ E_i(t) $：
- 产成品（反映工业生产规模）
- 工业用电量（反映能源消耗）
- 常住人口（反映人为活动强度）

### 气象因子 $ M_i(t) $：
- 月降水量 $ R_i(t) $
- 月平均气温 $ T_i(t) $

### 环境承载因子：
- 人均公园绿地面积
- 绿化覆盖率
- 生产用水量和人均日生活用水量（反映水资源利用）

基于这些变量，我们构建了如下微分方程模型：

$$
\frac{dA_i}{dt} = \alpha_i + \beta_i A_i(t) + \gamma_{1i} P_i(t) + \gamma_{2i} E_i(t) + \gamma_{3i} N_i(t) - \mu_{1i} R_i(t) - \mu_{2i} G_i(t) - \lambda_i A_i(t)
$$

其中：
- $ A_i(t) $ 为第 $ i $ 市时间 $ t $ 的空气质量综合指数
- $ P_i(t) $ 为产成品
- $ E_i(t) $ 为工业用电量
- $ N_i(t) $ 为常住人口
- $ R_i(t) $ 为月降水量
- $ G_i(t) $ 为绿化覆盖率
- $ \alpha_i $ 为基准积累项
- $ \beta_i $ 描述空气质量自身滞留效应
- $ \gamma_{1i} $, $ \gamma_{2i} $, $ \gamma_{3i} $ 为各污染源的敏感度系数
- $ \mu_{1i} $, $ \mu_{2i} $ 为气象和环境因子的敏感度系数
- $ \lambda_i $ 代表自然消散或治理强度

## 5.2.参数估计

利用2018-2022年的历史数据，通过最小二乘法估计模型参数。具体步骤如下：

1. 将微分方程离散化：
   \[
   A_i(t+\Delta t) - A_i(t) = \left[ \alpha_i + \beta_i A_i(t) + \gamma_{1i} P_i(t) + \gamma_{2i} E_i(t) + \gamma_{3i} N_i(t) - \mu_{1i} R_i(t) - \mu_{2i} G_i(t) - \lambda_i A_i(t) \right] \cdot \Delta t
   \]

2. 构建最小二乘目标函数：
   \[
   \min_{\alpha_i, \beta_i, \gamma_{1i}, \gamma_{2i}, \gamma_{3i}, \mu_{1i}, \mu_{2i}, \lambda_i} \sum_{t} \left[ A_i^{\text{实际}}(t+\Delta t) - A_i^{\text{预测}}(t+\Delta t) \right]^2
   \]

3. 求解最优参数集。

## 5.3.模型特性分析

1. **稳定性分析**：
   - 当 $ \beta_i - \lambda_i < 0 $ 时，系统具有稳定性，趋于平衡状态。
   - 稳态解为：

     \[
     A_i = \frac{\alpha_i + \gamma_{1i} P_i + \gamma_{2i} E_i + \gamma_{3i} N_i - \mu_{1i} R_i - \mu_{2i} G_i}{\lambda_i - \beta_i}
     \]

2. **参数敏感性**：
   - $ \gamma $ 系数越大，表示污染源对空气质量的影响越显著。
   - $ \mu $ 系数越大，表示气象和环境因子的净化作用越强。
   - $ \lambda_i $ 越大，表示自然消散或治理效果越好。

## 5.4.模型验证与评估

利用2023年1月-12月的实际数据评估模型预测准确性：

1. 以2022年12月的空气质量指数作为初值。
2. 使用估计的参数和2023年的输入变量，通过数值方法（如四阶Runge-Kutta法）求解微分方程。
3. 将预测结果与实际观测值比较，计算均方根误差（RMSE）和相关系数（$ R^2 $）。

## 5.5.敏感性分析

通过调整模型中的关键参数，我们分析了不同因素对空气质量的影响程度：

1. **污染源敏感性**：
   - 调整 $ \gamma_{1i} $、$ \gamma_{2i} $、$ \gamma_{3i} $ 系数，分别分析产成品、工业用电量和常住人口变化对空气质量的影响。
2. **气象因子敏感性**：
   - 调整 $ \mu_{1i} $、$ \mu_{2i} $ 系数，分析降水量和绿化覆盖率变化对空气质量的影响。
3. **治理强度敏感性**：
   - 调整 $ \lambda_i $，分析不同治理强度下空气质量的改善程度。

**敏感性分析方法**：
- 对每个关键参数进行±1%的扰动，观察空气质量指数 $ A_i(t) $ 的相对变化。
- 计算敏感性指标：
  \[
  S = \frac{\Delta A_i / A_i}{\Delta p / p}
  \]
  其中 $ p $ 为参数，$ \Delta p $ 为参数扰动量，$ \Delta A_i $ 为空气质量预测值的变化量。

**分析结果**：


- 识别对空气质量影响最大的特征，例如工业用电量或绿化覆盖率。
- 为政策制定提供依据，优先控制敏感性高的污染源。


# 六、空气质量预测模型


根据论文中的符号定义，下面详细介绍SARIMA和Prophet两种时间序列预测模型的训练推理公式，以及MSE评估方法的计算公式。

## 6.1.SARIMA模型

SARIMA (Seasonal AutoRegressive Integrated Moving Average) 是一种考虑季节性因素的时间序列预测模型。模型结合了普通 ARIMA 和季节性部分，其总体形式为：

$$
\Phi_P(B^s) \phi_p(B)(1 - B)^d (1 - B^s)^D y_t = \Theta_Q(B^s) \theta_q(B) \varepsilon_t
$$

其中：

* $B$ 是滞后算子（例如 $B y_t = y_{t-1}$）
* $\phi_p(B)$：AR 部分的多项式
* $\theta_q(B)$：MA 部分的多项式
* $\Phi_P(B^s)$：季节性 AR 部分
* $\Theta_Q(B^s)$：季节性 MA 部分
* $\varepsilon_t$：白噪声误差

在代码实现中，使用的SARIMA模型参数为SARIMAX(1,1,1)(1,1,1,12)，即：
- 非季节性部分：p=1（自回归阶数）, d=1（差分阶数）, q=1（移动平均阶数）
- 季节性部分：P=1（季节性自回归阶数）, D=1（季节性差分阶数）, Q=1（季节性移动平均阶数）, s=12（季节周期）

意味着模型形式是：

$$
(1 - \phi_1 B)(1 - B)(1 - B^{12}) y_t = (1 + \theta_1 B)(1 + \Theta_1 B^{12}) \varepsilon_t
$$

其中：

* $\phi_1$：AR 系数
* $\theta_1$：MA 系数
* $\Theta_1$：季节性 MA 系数

在拟合后，`get_forecast()` 做的是：根据模型中估计出来的参数（AR、MA、季节项等）和历史观测数据，对未来的数据点进行递推预测（一步一步向前滚动预测），使用递归的方法结合误差项来生成预测值和置信区间，这些预测值来自上述差分方程的“解”。

## 6.2.Prophet模型

Prophet是Facebook开发的时间序列预测模型，特别适合具有强季节性和多个季节性的时间序列。Prophet 代码的训练和预测过程可以从 **数学建模机制** 和 **贝叶斯参数估计原理** 两个角度来理解。Facebook Prophet 是一个加法时间序列模型，其基本形式如下：

$$
y(t) = g(t) + s(t) + h(t) + \varepsilon_t
$$

其中：

* $g(t)$：趋势（trend）函数，表示长期增长或下降趋势
* $s(t)$：季节性（seasonality）函数，如年度、周、日季节性等
* $h(t)$：节假日（holidays）效应（可选）
* $\varepsilon_t$：噪声项，假设为独立同分布的高斯误差项

### 趋势模型`g(t)`：
Prophet 提供两种趋势模型：

* **线性趋势**：

  $$
  g(t) = (k + a(t)^T \delta)t + (m + a(t)^T \gamma)
  $$

  用于处理趋势在某些时间点（changepoints）发生变化的情况。

* **logistic 增长趋势**：

  $$
  g(t) = \frac{C}{1 + \exp(-k(t - m))}
  $$

  其中 $C$ 是饱和容量（可设为常数或变量）


### 季节性项（`s(t)`）

季节性部分使用傅里叶级数建模，形式为：

$$
s(t) = \sum_{n=1}^N [a_n \cos(\frac{2\pi n t}{P}) + b_n \sin(\frac{2\pi n t}{P})]
$$

* $P$：季节周期，比如 365.25（年季节性），7（周季节性），那么在本任务中，季节应该为一年也就是365.25
* $N$：傅里叶级数的阶数，控制季节性的灵活程度（默认为 10）


### 假期项（`h(t)`）

如果提供节假日表，Prophet 会给每个假期分配一个影响值 $\beta$，构建类似哑变量的模型：

$$
h(t) = \sum_{i} \beta_i \cdot \mathbf{1}_{\text{holiday}_i}(t)
$$
在这个模型中就没有使用到该项

### Prophet 的训练过程：贝叶斯估计


Prophet 的 `.fit()` 实质上是 **最大后验估计（MAP）** 的贝叶斯过程，使用 **Stan** 语言构建模型并调用 **cmdstanpy** 或 **pystan** 来拟合。它不是全采样（MCMC），而是用优化方式近似得到贝叶斯后验：

* 对模型参数（如趋势变化点、季节性傅里叶系数等）指定正则先验分布
* 使用 Stan 内部优化器对后验进行最大化（不是完整采样）
* 拟合结果为各参数的最优点估计值（和不确定性）



### 预测过程 `predict()` 的原理

这个步骤背后做的是：

* 用拟合后的 $g(t) + s(t) + h(t)$ 模型，在未来时间点 $t$ 上代入参数进行计算
* 同时 Prophet 会给出：

  * `yhat`：预测值
  * `yhat_lower` 和 `yhat_upper`：预测区间（基于贝叶斯先验生成的不确定性）

| 组成                 | 数学形式                 | 模型中作用             |
| -------------------- | ------------------------ | ---------------------- |
| 趋势 $g(t)$          | 分段线性或 logistic 增长 | 捕捉长期变化           |
| 季节 $s(t)$          | 傅里叶级数               | 年/周/月重复模式       |
| 节假日 $h(t)$        | 指示变量                 | 考虑突发性事件         |
| 误差 $\varepsilon_t$ | 正态噪声                 | 捕捉模型无法解释的波动 |


## 6.3.MSE评估方法

均方误差（Mean Squared Error, MSE）是评估预测模型性能的常用指标。

### 计算公式

根据论文中的符号定义，MSE计算公式为：

$$MSE = \frac{1}{n}\sum_{t=1}^{n}(A_i^{\text{实际}}(t) - A_i^{\text{预测}}(t))^2$$

其中：
- $A_i^{\text{实际}}(t)$ 表示第 $i$ 市在时间 $t$ 的实际空气质量综合指数
- $A_i^{\text{预测}}(t)$ 表示第 $i$ 市在时间 $t$ 的预测空气质量综合指数
- $n$ 是预测点的数量

在代码中，MSE的计算通过sklearn库的`mean_squared_error`函数实现：

## 6.4.模型比较与应用

在代码实现中，通过比较两种模型的MSE值来选择更优的模型：对于每个城市，选择MSE较小的模型用于2024年的预测：

最后，通过可视化方式展示各城市两种模型的MSE对比，直观地呈现模型性能差异，为选择最优预测模型提供依据。

通过这种方式，研究充分利用了时间序列预测方法的优势，结合了SARIMA模型对时间依赖性的精确建模和Prophet模型对季节性模式的灵活捕捉，为江苏省各市空气质量的未来趋势提供了科学的预测依据。



# 七、江苏省13个城市空气质量区域协同治理分析


## 7.1.数据观察与核心结论
1. **沿海城市AQI优势显著**  
   - 直方图显示，**盐城、南通、苏州、连云港**四个沿海城市空气质量最佳（AQI均值最低），其中盐城长期表现最优。非沿海城市中仅泰州进入前五，可能与当地产业结构（轻工业为主）和环保政策严格相关。  
   - **徐州AQI最差**，宿迁次之，二者均位于苏北内陆，且同为MSE（预测误差）最高的城市，表明其空气质量波动剧烈、预测难度大。

2. **内陆污染重灾区与预测挑战**  
   - 徐州、宿迁长期位列空气质量最差前三，MSE显著高于其他城市，可能原因：  
     - **工业排放复杂**：徐州（钢铁、煤炭）和宿迁（化工、建材）依赖高污染产业，生产波动导致污染物排放不稳定。  
     - **气象条件多变**：内陆地区冬季逆温频率高，叠加沙尘输入（徐州靠近华北平原），加剧污染物积累与突发性污染事件。  
     - **跨区域传输叠加**：徐州作为苏鲁豫皖交界城市，易受外部污染输入影响，本地与外来污染叠加导致模型难以捕捉规律。


## 7.2.关键影响因素解析
1. **地理与气候的核心作用**  
   - **沿海扩散优势**：盐城、南通等沿海城市受益于海风强、湿度高，污染物易扩散；雨水频繁（年均降水量1200mm以上）促进颗粒物沉降，显著降低PM2.5浓度。  
   - **内陆地形劣势**：徐州、宿迁地处黄淮平原，地势平坦但冬季静稳天气多发，逆温层阻碍垂直扩散，PM2.5易累积至峰值。

2. **社会经济因素差异化影响**  
   | 因素           | 沿海城市（如盐城、南通）                   | 内陆城市（如徐州、宿迁）                     |
   | -------------- | ------------------------------------------ | -------------------------------------------- |
   | **工业用电量** | 中等影响（清洁能源占比高，如南通海上风电） | 影响权重低 （煤炭依赖度超60%，工业排放主导） |
   | **常住人口**   | 影响程度低（人口密度适中，交通污染可控）   | 影响不大（人口外流，工业污染掩盖生活源）     |
   | **月降水量**   | 强负相关（降雨直接冲刷污染物）             | 相关性中等（干旱季长，降水改善有限）         |


3. **特例分析：泰州的“非沿海优势”**  
   - 尽管非沿海，泰州AQI优于部分沿海城市，可能原因：  
     - **产业结构轻型化**：医药、机电产业占主导，VOCs排放量低于重工业城市；  
     - **湿地修复效应**：里下河湿地系统吸附颗粒物，局部微气候改善显著。


## 7.3.协同治理策略优化
1. **分区精准管控**  
   - **沿海城市群**（盐城、南通、连云港）：  
     - 强化“海陆风通道”保护，限制港口周边石化项目扩建；  
     - 推广雨水蓄滞净化工程，增强降水对污染物的清除效率。  
   - **内陆工业带**（徐州、宿迁、淮安）：  
     - 强制钢铁、化工企业安装实时排放监测系统，实施“红黄绿”三级限产预警；  
     - 与山东、安徽共建跨省污染传输监控网络，减少外部输入影响。

2. **动态模型优化**  
   - 针对高MSE城市（徐州、宿迁），引入气象预警数据（逆温层厚度、沙尘轨迹）和工业实时用电量，提升ARIMA模型预测精度。  
   - 建立“污染源-气象-地理”耦合数据库，识别徐州突发性污染的主因（如本地燃煤 vs 外部沙尘）。

3. **政策杠杆设计**  
   - **差异化生态补偿**：  
     - 对徐州、宿迁实施“单位工业增加值排污强度”考核，超标企业向沿海城市支付生态修复基金；  
     - 沿海城市将补偿金用于湿地扩建与港口清洁化改造。  
   - **气候韧性投资**：  
     - 在宿迁、徐州推广屋顶光伏+农业大棚，降低燃煤依赖；  
     - 盐城、南通试点“风电制氢+工业脱碳”，减少天然气消费的污染增量。


## 7.4.预期成效  
- **短期（1-2年）**：徐州、宿迁PM2.5日均峰值下降10%-15%，沿海城市臭氧超标天数减少20%；  
- **长期（5年）**：全省空气质量优良率从82%提升至88%，徐州工业排放强度下降30%，区域预测模型MSE降低25%。

