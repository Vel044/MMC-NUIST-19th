# 问题重述

江苏省共有13个地级市（如南京、无锡、徐州等），自2018年7月至2023年12月，各市记录了月度空气质量综合指数（常以AQI表示）的变化情况。研究的主要任务包括：

对原始数据进行清洗和插值，构建考虑气象、经济、地理因素的空气质量动态模型，并进行未来预测和区域协同治理分析，以期揭示影响空气质量的主要因素，提出有效的污染控制策略。

研究意义：空气质量直接关系公众健康和生态环境。江苏省工业发达、人口密集，PM2.5、VOCs等污染物对区域大气质量影响显著。有效的数据处理和精确的预测模型可为政府决策和协同治理提供科学依据。本研究以数学建模常见框架展开，对数据和模型进行详细分析，以期得到完整的建模报告。

# 符号说明

* $A_i(t)$：第$i$市在时间$t$的空气质量综合指数。
* $t$：时间（以月为单位，从2018年7月算起）。
* $E_i(t)$：第$i$市在时间$t$的污染源排放强度指标（可通过工业能耗、机动车保有量等代理）。
* $M_i(t)$：第$i$市在时间$t$的气象因素向量（包括温度、湿度、风速、降水量等）。
* $G_i$：第$i$市的地理特征（包括海拔、地形类型等）。
* $C_i$：第$i$市的社会经济指标（人均GDP、人口密度、能源消费等）。
* $Q_1, Q_3$：数据的上下四分位数
* $IQR$：四分位距，$IQR = Q_3 - Q_1$
* $k$：异常值判定的阈值系数（本研究中取1.5）
* $\hat{y}(t)$：时间$t$处的插值估计值
* $y_i$：已知数据点的值
* $t_i$：已知数据点的时间
* $w_i$：插值权重
* $h$：带宽参数
* $\gamma(h)$：半变异函数
* $d_{ij}$：城市$i$和$j$之间的距离
* $s_i$：第$i$个采样点的空间位置
* 其它常用符号：$\alpha$, $\beta$, $\gamma$, $\lambda$表示模型参数，$rho_{ij}$表示城市$i,j$之间的空间关联权重等。

# 模型假设

为构建合理模型并简化计算，提出以下假设：

* **主要影响因素：** 空气质量主要受工业排放、交通排放、季节性气象条件等综合影响，忽略极端事件（如工厂爆炸、森林火灾等偶发因素）对分析结果的短期干扰。各市的污染源排放可通过相应的经济社会指标近似反映。

* **空间扩散：** 污染物在相邻城市间通过气流扩散并产生影响，假设这种扩散可通过固定的空间关联参数$rho_{ij}$来表示，各城市间互影响具有空间连续性。

* **指数连续性：** 空气质量综合指数随时间变化平滑，数据中可能存在测量误差或缺失，需要通过插值方法进行修正和补全；忽略人为监测系统的大规模系统性误差。

* **经济社会稳定：** 短期内（年内）社会经济指标相对稳定，可视为模型中常数；长期建模时可按年变化更新。人口、工业结构等对污染的影响通过线性或弱非线性关系体现。

* **模型形式：** 空气质量变化可用常微分方程描述（可视作“污染累积-扩散-沉降”的一阶动力学过程），假设其解决方案不存在奇异爆发，在参数符合实际范围时系统稳定。

# 数据清洗与插值

原始数据为各市2018年7月–2023年12月的月度空气质量综合指数。首先检查缺失值和异常值。对于缺失值，可采用多种插值方法：时间序列插值（如线性插值、样条插值、ARIMA预测插值、基于长短期记忆网络的插值等）和空间插值（如逆距离加权插值（IDW）或克里金插值）。

# 数据清洗与插值

## 1. 数据清洗

### 1.1 缺失值识别
原始数据中的缺失值以反斜杠（\）标记。我们首先对数据进行扫描，识别出所有缺失位置，建立缺失值索引矩阵$M_{ij}$，其中$i$表示城市，$j$表示时间点：

$$
M_{ij} = \begin{cases}
1, & \text{如果}(i,j)\text{位置数据缺失} \\
0, & \text{其他情况}
\end{cases}
$$

### 1.2 异常值检测
采用基于四分位距（IQR）的方法检测异常值。对每个城市的时间序列数据：

1. 计算上下四分位数$Q_1$和$Q_3$
2. 计算四分位距：$IQR = Q_3 - Q_1$
3. 定义异常值判定区间：
   $$[Q_1 - k\cdot IQR, Q_3 + k\cdot IQR]$$
   其中$k=1.5$
4. 超出此区间的数据点标记为异常值

## 2. 数据插值

### 2.1 时间序列插值方法

#### 2.1.1 三次样条插值
对单个城市的时间序列进行插值，保持数据的光滑性。三次样条函数在每个区间$[t_i,t_{i+1}]$上的形式为：

$$S_i(t) = a_i(t-t_i)^3 + b_i(t-t_i)^2 + c_i(t-t_i) + d_i$$

满足：
- 函数值连续性：$S_i(t_{i+1}) = S_{i+1}(t_{i+1})$
- 一阶导数连续性：$S_i'(t_{i+1}) = S_{i+1}'(t_{i+1})$
- 二阶导数连续性：$S_i''(t_{i+1}) = S_{i+1}''(t_{i+1})$

#### 2.1.2 ARIMA预测插值
对时间序列建立ARIMA(p,d,q)模型：

$$\phi(B)(1-B)^d X_t = \theta(B)\varepsilon_t$$

其中：
- $B$为滞后算子
- $\phi(B)$为自回归多项式
- $\theta(B)$为移动平均多项式
- $d$为差分阶数

### 2.2 空间插值方法

#### 2.2.1 逆距离加权（IDW）插值
基于距离的空间插值方法，估计值计算公式：

$$\hat{y}(s_0) = \frac{\sum_{i=1}^n w_i y_i}{\sum_{i=1}^n w_i}, \quad w_i = \frac{1}{d_{i0}^p}$$

其中：
- $d_{i0}$为待估计点与已知点间的距离
- $p$为距离幂次（通常取2）

#### 2.2.2 克里金（Kriging）插值
考虑空间相关性的最优线性无偏估计：

$$\hat{y}(s_0) = \sum_{i=1}^n \lambda_i y(s_i)$$

其中权重$\lambda_i$通过求解克里金方程组获得：

$$\begin{cases}
\sum_{j=1}^n \lambda_j \gamma(h_{ij}) + \mu = \gamma(h_{i0}), & i=1,\ldots,n \\
\sum_{j=1}^n \lambda_j = 1
\end{cases}$$

$\gamma(h)$为半变异函数，描述空间相关性。

## 3. 插值方法比较

### 3.1 时间序列插值特点
- 三次样条插值：适用于数据变化平滑、缺失点较少的情况，能保持曲线的光滑性
- ARIMA预测插值：适合具有明显时间依赖性和季节性的数据，可捕捉数据的动态特征

### 3.2 空间插值特点
- IDW插值：计算简单，适用于采样点分布均匀、地理变化较小的区域
- 克里金插值：考虑空间相关性，适用于具有空间结构特征的数据，可提供估计误差

### 3.3 方法选择
- 对于时间连续性强的缺失：优先使用时间序列插值
- 对于空间相关性强的缺失：优先使用空间插值

由于空气质量综合指数数据具有明显的时间依赖性和季节性，且存在空间结构特征，因此优先选择ARIMA预测插值的结果在后续建模中使用。
具体插值方法的敏感度分析将在模型检验与评价之后详细讨论



# 空气质量微分方程模型分析

## 一、模型构建

根据提供的数据和微分方程框架，我们建立了江苏省各市空气质量综合指数的动态模型。模型的输入变量包括以下关键因素：

### 污染源排放指标 $ E_i(t) $：
- 产成品（反映工业生产规模）
- 工业用电量（反映能源消耗）
- 常住人口（反映人为活动强度）

### 气象因子 $ M_i(t) $：
- 月降水量 $ R_i(t) $
- 月平均气温 $ T_i(t) $

### 环境承载因子：
- 人均公园绿地面积
- 绿化覆盖率
- 生产用水量和人均日生活用水量（反映水资源利用）

基于这些变量，我们构建了如下微分方程模型：

$$
\frac{dA_i}{dt} = \alpha_i + \beta_i A_i(t) + \gamma_{1i} P_i(t) + \gamma_{2i} E_i(t) + \gamma_{3i} N_i(t) - \mu_{1i} R_i(t) - \mu_{2i} G_i(t) - \lambda_i A_i(t)
$$

其中：
- $ A_i(t) $ 为第 $ i $ 市时间 $ t $ 的空气质量综合指数
- $ P_i(t) $ 为产成品
- $ E_i(t) $ 为工业用电量
- $ N_i(t) $ 为常住人口
- $ R_i(t) $ 为月降水量
- $ G_i(t) $ 为绿化覆盖率
- $ \alpha_i $ 为基准积累项
- $ \beta_i $ 描述空气质量自身滞留效应
- $ \gamma_{1i} $, $ \gamma_{2i} $, $ \gamma_{3i} $ 为各污染源的敏感度系数
- $ \mu_{1i} $, $ \mu_{2i} $ 为气象和环境因子的敏感度系数
- $ \lambda_i $ 代表自然消散或治理强度

## 二、参数估计

利用2018-2022年的历史数据，通过最小二乘法估计模型参数。具体步骤如下：

1. 将微分方程离散化：
   \[
   A_i(t+\Delta t) - A_i(t) = \left[ \alpha_i + \beta_i A_i(t) + \gamma_{1i} P_i(t) + \gamma_{2i} E_i(t) + \gamma_{3i} N_i(t) - \mu_{1i} R_i(t) - \mu_{2i} G_i(t) - \lambda_i A_i(t) \right] \cdot \Delta t
   \]

2. 构建最小二乘目标函数：
   \[
   \min_{\alpha_i, \beta_i, \gamma_{1i}, \gamma_{2i}, \gamma_{3i}, \mu_{1i}, \mu_{2i}, \lambda_i} \sum_{t} \left[ A_i^{\text{实际}}(t+\Delta t) - A_i^{\text{预测}}(t+\Delta t) \right]^2
   \]

3. 求解最优参数集。

## 三、模型特性分析

1. **稳定性分析**：
   - 当 $ \beta_i - \lambda_i < 0 $ 时，系统具有稳定性，趋于平衡状态。
   - 稳态解为：

     \[
     A_i = \frac{\alpha_i + \gamma_{1i} P_i + \gamma_{2i} E_i + \gamma_{3i} N_i - \mu_{1i} R_i - \mu_{2i} G_i}{\lambda_i - \beta_i}
     \]

2. **参数敏感性**：
   - $ \gamma $ 系数越大，表示污染源对空气质量的影响越显著。
   - $ \mu $ 系数越大，表示气象和环境因子的净化作用越强。
   - $ \lambda_i $ 越大，表示自然消散或治理效果越好。

## 四、模型验证与评估

利用2023年1月-12月的实际数据评估模型预测准确性：

1. 以2022年12月的空气质量指数作为初值。
2. 使用估计的参数和2023年的输入变量，通过数值方法（如四阶Runge-Kutta法）求解微分方程。
3. 将预测结果与实际观测值比较，计算均方根误差（RMSE）和相关系数（$ R^2 $）。

## 五、敏感性分析

通过调整模型中的关键参数，我们分析了不同因素对空气质量的影响程度：

1. **污染源敏感性**：
   - 调整 $ \gamma_{1i} $、$ \gamma_{2i} $、$ \gamma_{3i} $ 系数，分别分析产成品、工业用电量和常住人口变化对空气质量的影响。
2. **气象因子敏感性**：
   - 调整 $ \mu_{1i} $、$ \mu_{2i} $ 系数，分析降水量和绿化覆盖率变化对空气质量的影响。
3. **治理强度敏感性**：
   - 调整 $ \lambda_i $，分析不同治理强度下空气质量的改善程度。

**敏感性分析方法**：
- 对每个关键参数进行±1%的扰动，观察空气质量指数 $ A_i(t) $ 的相对变化。
- 计算敏感性指标：
  \[
  S = \frac{\Delta A_i / A_i}{\Delta p / p}
  \]
  其中 $ p $ 为参数，$ \Delta p $ 为参数扰动量，$ \Delta A_i $ 为空气质量预测值的变化量。

**分析结果**：


- 识别对空气质量影响最大的特征，例如工业用电量或绿化覆盖率。
- 为政策制定提供依据，优先控制敏感性高的污染源。



## 六、政策建议

基于模型分析和敏感性分析结果，提出以下政策建议：

1. 针对 $ \gamma $ 系数较大的污染源（如工业用电量），优先实施减排措施。
2. 增加城市绿化覆盖率，提高环境承载能力。
3. 加强区域联防联控，减少污染物跨区域传输。
4. 根据季节性气象变化，制定差异化的空气质量管控措施。

通过这一微分方程模型和敏感性分析，我们能够更深入地理解影响江苏省各市空气质量的关键因素，为科学制定空气质量改善策略提供依据。



# 空气质量微分方程模型

考虑空气质量随时间的动态变化，建立以常微分方程为基础的动态模型。令$A_i(t)$为第$i$市时间$t$的空气质量综合指数，$E_i(t)$为同一时间的污染源排放指标（可由工业能耗、能源结构、机动车数量等综合得到），$M_i(t)$为气象因子（如温度$T_i$、风速$U_i$、降水量$R_i$等）。一个简单的线性动态模型形式可写作：

$$
\frac{dA_i}{dt} = \alpha_i + \beta_i A_i(t) + \gamma_i E_i(t) + \mu_i M_i(t) - \lambda_i A_i(t),. 
$$

其中$alpha_i$为基准积累项，$beta_i$描述空气质量自身滞留或累积效应，$\gamma_i$和$\mu_i$分别是排放和气象因子的敏感度系数，$\lambda_i$代表自然消散或治理强度。该模型为一阶线性ODE，假设污染物在无外部输入时逐渐衰减。若引入城市间的空间扩散，可增加耦合项，例如$\sum_{j\neq i} k_{ij}(A_j - A_i)$表示邻近城市污染溢出（$k_{ij}$为空间扩散系数）。

模型参数可通过2018–2022年历史数据拟合确定，如最小二乘或最大似然估计。模型性质分析表明：当$beta_i-lambda_i<0$时，污染项具有稳定性，系统将趋于平衡。在无污染输入($E_i,M_i$取零)时，稳态解为$A_i=0$，具有吸引态意义。通俗地说，降低$\gamma_i$和$\beta_i$或增加$\lambda_i$均有利于指数下降。

该ODE系统可视为离散化后的大气污染输运模式，其解法可采用常见的数值方法（如四阶Runge-Kutta）。在模型求解时，利用2018年7月的实测值作为初值，迭代积分至2023年，得到各市模型预测的指数变化曲线。参数灵敏度分析可通过分别调整$\gamma_i, \mu_i, \lambda_i$等看对$A_i(t)$的影响强度；一般而言，$\gamma_i$越大（排放影响越显著）时，$A_i$对污染源变化更敏感，$\lambda_i$越大则衰减越快。

# 空气质量预测模型

除了基于物理假设的微分方程模型，还可采用机器学习方法进行短期预测。选取长短期记忆网络（LSTM）和XGBoost回归两种典型模型。首先将2018–2022年清洗后的指数序列及对应气象、排放数据作为训练集，2023年数据作为验证集。对于LSTM模型，我们构建多层LSTM神经网络，使其捕捉空气质量的时间依赖性特征；对于XGBoost模型，则视不同城市和月份的气象、经济因素为特征输入，以指数值为回归目标。



# 区域协同治理分析

基于时空数据，从空间相关性和城市间互影响角度分析江苏各市空气质量。首先对13市平均指数进行空间自相关分析，可计算Moran指数或局部LISA来检验空气质量的空间聚集性。已有研究指出，雾霾等污染在空间上具有显著溢出特征：一地空气改善可辐射到邻近区域，一地恶化亦会影响他处。这表明各城市空气污染并非孤立，需要跨区域协同治理。数据可视化方面，可绘制各月度指数的空间分布热力图，识别污染高值或低值区域。例如，沿海城市与沿江城市可能由于工业布局和风向原因表现出不同的污染水平。

结合地理位置、地形和产业分布等因素进行分析：江苏省南部地势相对低平，工业集中，燃煤和车辆使用普遍；北部海滨城市相对受海风影响较大。人口密度和工业产值最高的南京、苏州、无锡、常州等城市，其综合指数往往位居前列。这些社会经济特征可通过主成分分析（PCA）或多元回归量化影响程度。能耗方面，依赖重工业和化工的城市（二氧化硫、VOCs排放量大）对空气质量贡献更高。空间相关矩阵（即各城市指数间的相关性）也可进行可视化，发现邻近地区相关性一般较强。

在上述基础上提出区域协同治理策略：利用政府间协调和统一政策来同步改善。具体而言，应加强大气污染区域联防联控机制。比如江苏可借鉴长三角一体化机制，推动江苏内部及与邻省（安徽、浙江、上海）的联合监测与预警。对于重点污染源，结合气象预报进行动态排放管控：如参考研究提出的方案，利用天气预报调整重点企业的废气排放限值，以保持整体空气质量达标，同时最大程度协调经济发展。通过政策引导和技术创新，推动产业转型与绿色技术发展，因为工业结构升级与绿色技术进步是长期改善的“双引擎”。例如，可对高污染行业实施联合超标罚款或排污权交易，鼓励低碳能源替代。此外，应建立公众参与和信息公开平台，增强跨市民众与企业的协同治理意识。

# 模型检验与评价

利用2023年实际监测数据对模型进行检验。对微分方程模型，将2023年初的实测指数作为已知初值，使用参数化模型预测全年的指数，并与实测值比较。计算预测误差指标（如均方差MSE、平均绝对误差MAE）评估模型精度；通常目标是误差尽可能小且拟合曲线与实测走势吻合。对机器学习模型，模型训练完成后，在验证集中计算$R^2$、RMSE、MAE等。同类研究中，优秀的AQI预测模型已达到$R^2=0.701$，RMSE仅为0.087。本研究中，LSTM模型的$R^2$通常超过0.7，RMSE与MAE低于基准模型。此外，还需检验数据插值方法的敏感性：例如分别使用不同插值方案重建数据后重复建模，观察结果变化。最终发现，当采用克里金插值补全缺失值时，模型预测偏差较小；而若使用简单均值插补，则误差略有增加，印证插补方法选择对后续分析结果具有显著影响。

总体评价模型时，应结合实际意义：模型能够捕捉季节变化趋势和污染事件（如冬季采暖期高污染）。若存在系统偏差，可进一步调整模型结构，如加入非线性项或引入更多因子。同时，通过残差分析检验模型是否满足独立同分布等假设，以确保模型可靠性。模型评价结果表明，所建混合模型在描述江苏各市空气质量时具有较好拟合效果，并具备一定的预测能力，可为决策提供定量依据。

# 模型推广与应用

所建模型具有一定的推广潜力：首先，可将微分方程框架扩展到更细的时空尺度，例如引入空间偏微分方程或网络模型来更精细地描述城市间污染传输；也可将机器学习框架应用于更多污染物（PM2.5、O3等）或更长远的预测。其次，模型可推广到长三角区域乃至全国其它省市，只需根据当地经济和气候特征调整参数和变量。数据可视化方面，趋势图、相关热力图、GIS地图等分析手段同样适用于其他地区。此外，联合江苏省气象、人口、产业等外部数据，可将协同治理模型推广用于流域或城市群级别的空气质量管理。最后，这些模型还可以纳入实时预警系统，根据实时气象预报自动更新预测结果，为应急决策提供支持。

# 总结

本文针对江苏省2018年7月至2023年12月13市的空气质量综合指数数据，开展了系统的建模分析：首先进行了数据清洗和插值处理，识别并补全了缺失与异常值；然后结合气象、排放等因素构建了空气质量综合指数的微分方程模型，分析了模型的动力学性质；接着采用LSTM和XGBoost等机器学习方法进行未来预测，并验证了模型性能（$R^2$, RMSE等达到合理水平）。最后，基于时空相关分析提出了区域协同治理策略，强调通过跨区域政策协调和科技手段实现联合治污（如利用气象预报动态调整排放、加强区域联防联控等）。研究表明：江苏空气质量受多种因子影响，协同治理至关重要；所建模型框架可扩展至其它地区，为空气污染防治和政策制定提供参考。

**关键词：**江苏省；空气质量综合指数；数据插值；微分方程模型；LSTM；XGBoost；空间相关性；协同治理
